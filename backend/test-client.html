<!DOCTYPE html>
<html>
<head>
  <title>WebSocket Test</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    #output { border: 1px solid #ccc; padding: 10px; height: 300px; overflow-y: auto; margin-bottom: 10px; }
    button { margin-right: 10px; padding: 5px 10px; }
  </style>
</head>
<body>
  <h2>WebSocket Test Client</h2>
  <div id="output"></div>
  <button id="connect">Connect</button>
  <button id="subscribe">Subscribe to Agents</button>
  <button id="disconnect">Disconnect</button>

  <script>
    const output = document.getElementById('output');
    let socket;
    
    function log(message) {
      const div = document.createElement('div');
      div.textContent = message;
      output.appendChild(div);
      output.scrollTop = output.scrollHeight;
    }
    
    document.getElementById('connect').addEventListener('click', () => {
      socket = new WebSocket('ws://localhost:3001');
      
      socket.onopen = () => {
        log('Connected to server');
      };
      
      socket.onmessage = (event) => {
        const data = JSON.parse(event.data);
        log(`Received: ${JSON.stringify(data, null, 2)}`);
      };
      
      socket.onclose = () => {
        log('Disconnected from server');
      };
      
      socket.onerror = (error) => {
        log(`Error: ${error}`);
      };
    });
    
    document.getElementById('subscribe').addEventListener('click', () => {
      if (socket && socket.readyState === WebSocket.OPEN) {
        socket.send(JSON.stringify({
          type: 'subscribe',
          collection: 'agent',
          limit: 10
        }));
        log('Subscribed to agent collection');
      } else {
        log('Not connected to server');
      }
    });
    
    document.getElementById('disconnect').addEventListener('click', () => {
      if (socket) {
        socket.close();
        log('Disconnected from server');
      }
    });
  </script>
</body>
</html> 